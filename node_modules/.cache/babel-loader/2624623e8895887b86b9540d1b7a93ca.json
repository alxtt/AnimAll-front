{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\AnimAll-react-sketch \\u2014 \\u043A\\u043E\\u043F\\u0438\\u044F\\\\src\\\\pages\\\\ExternalApi.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { Button, Alert } from \"reactstrap\";\nimport { useAuth0, withAuthenticationRequired } from \"@auth0/auth0-react\";\nimport { getConfig } from \"../config\";\nimport Loading from \"../components/Loading\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const ExternalApiComponent = () => {\n  _s();\n\n  const {\n    apiOrigin = \"http://localhost:3000\",\n    audience\n  } = getConfig();\n  const [state, setState] = useState({\n    showResult: false,\n    apiMessage: \"\",\n    error: null\n  });\n  const {\n    getAccessTokenSilently,\n    loginWithPopup,\n    getAccessTokenWithPopup\n  } = useAuth0();\n\n  const handleConsent = async () => {\n    try {\n      await getAccessTokenWithPopup();\n      setState({ ...state,\n        error: null\n      });\n    } catch (error) {\n      setState({ ...state,\n        error: error.error\n      });\n    }\n\n    await callApi();\n  };\n\n  const handleLoginAgain = async () => {\n    try {\n      await loginWithPopup();\n      setState({ ...state,\n        error: null\n      });\n    } catch (error) {\n      setState({ ...state,\n        error: error.error\n      });\n    }\n\n    await callApi();\n  };\n\n  const callApi = async () => {\n    try {\n      const token = await getAccessTokenSilently();\n      const response = await fetch(`${apiOrigin}/api/external`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const responseData = await response.json();\n      setState({ ...state,\n        showResult: true,\n        apiMessage: responseData\n      });\n    } catch (error) {\n      setState({ ...state,\n        error: error.error\n      });\n    }\n  };\n\n  const handle = (e, fn) => {\n    e.preventDefault();\n    fn();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-5\",\n      children: [state.error === \"consent_required\" && /*#__PURE__*/_jsxDEV(Alert, {\n        color: \"warning\",\n        children: [\"You need to\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"#/\",\n          class: \"alert-link\",\n          onClick: e => handle(e, handleConsent),\n          children: \"consent to get access to users api\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this), state.error === \"login_required\" && /*#__PURE__*/_jsxDEV(Alert, {\n        color: \"warning\",\n        children: [\"You need to\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"#/\",\n          class: \"alert-link\",\n          onClick: e => handle(e, handleLoginAgain),\n          children: \"log in again\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        color: \"primary\",\n        className: \"mt-5\",\n        onClick: callApi,\n        disabled: !audience,\n        children: \"Ping API\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"result-block-container\",\n      children: state.showResult && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"result-block\",\n        \"data-testid\": \"api-result\",\n        children: /*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"muted\",\n          children: \"Result\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(ExternalApiComponent, \"ed2YcTMvN8RLqSp2w/noWPz50zg=\", false, function () {\n  return [useAuth0];\n});\n\n_c = ExternalApiComponent;\nexport default _c2 = withAuthenticationRequired(ExternalApiComponent, {\n  onRedirecting: () => /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 24\n  }, this)\n});\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ExternalApiComponent\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["C:/Users/User/Documents/AnimAll-react-sketch — копия/src/pages/ExternalApi.js"],"names":["React","useState","Button","Alert","useAuth0","withAuthenticationRequired","getConfig","Loading","ExternalApiComponent","apiOrigin","audience","state","setState","showResult","apiMessage","error","getAccessTokenSilently","loginWithPopup","getAccessTokenWithPopup","handleConsent","callApi","handleLoginAgain","token","response","fetch","headers","Authorization","responseData","json","handle","e","fn","preventDefault","onRedirecting"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { Button, Alert } from \"reactstrap\";\nimport { useAuth0, withAuthenticationRequired } from \"@auth0/auth0-react\";\nimport { getConfig } from \"../config\";\nimport Loading from \"../components/Loading\";\n\nexport const ExternalApiComponent = () => {\n  const { apiOrigin = \"http://localhost:3000\", audience } = getConfig();\n\n  const [state, setState] = useState({\n    showResult: false,\n    apiMessage: \"\",\n    error: null,\n  });\n\n  const {\n    getAccessTokenSilently,\n    loginWithPopup,\n    getAccessTokenWithPopup,\n  } = useAuth0();\n\n  const handleConsent = async () => {\n    try {\n      await getAccessTokenWithPopup();\n      setState({\n        ...state,\n        error: null,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n\n    await callApi();\n  };\n\n  const handleLoginAgain = async () => {\n    try {\n      await loginWithPopup();\n      setState({\n        ...state,\n        error: null,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n\n    await callApi();\n  };\n\n  const callApi = async () => {\n    try {\n      const token = await getAccessTokenSilently();\n\n      const response = await fetch(`${apiOrigin}/api/external`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      const responseData = await response.json();\n\n      setState({\n        ...state,\n        showResult: true,\n        apiMessage: responseData,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n  };\n\n  const handle = (e, fn) => {\n    e.preventDefault();\n    fn();\n  };\n\n  return (\n    <>\n      <div className=\"mb-5\">\n        {state.error === \"consent_required\" && (\n          <Alert color=\"warning\">\n            You need to{\" \"}\n            <a\n              href=\"#/\"\n              class=\"alert-link\"\n              onClick={(e) => handle(e, handleConsent)}\n            >\n              consent to get access to users api\n            </a>\n          </Alert>\n        )}\n\n        {state.error === \"login_required\" && (\n          <Alert color=\"warning\">\n            You need to{\" \"}\n            <a\n              href=\"#/\"\n              class=\"alert-link\"\n              onClick={(e) => handle(e, handleLoginAgain)}\n            >\n              log in again\n            </a>\n          </Alert>\n        )}\n\n        <Button\n          color=\"primary\"\n          className=\"mt-5\"\n          onClick={callApi}\n          disabled={!audience}\n        >\n          Ping API\n        </Button>\n      </div>\n\n      <div className=\"result-block-container\">\n        {state.showResult && (\n          <div className=\"result-block\" data-testid=\"api-result\">\n            <h6 className=\"muted\">Result</h6>\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default withAuthenticationRequired(ExternalApiComponent, {\n  onRedirecting: () => <Loading />,\n});\n"]},"metadata":{},"sourceType":"module"}